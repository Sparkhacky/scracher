{% extends "layout.html" %}
{% block content %}

<form class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-6">
  <input name="q" value="{{ q }}" placeholder="Buscar por URL, dominio o título..."
    class="bg-slate-900 border border-slate-700 rounded-xl px-4 py-2 outline-none"/>

  <select name="tech" class="bg-slate-900 border border-slate-700 rounded-xl px-4 py-2">
    <option value="">— Tecnología —</option>
    {% for t in techs %}
      <option value="{{ t['name'] }}" {% if tech==t['name'] %}selected{% endif %}>
        {{ t['name'] }} ({{ t['c'] }})
      </option>
    {% endfor %}
  </select>

  <select name="status" class="bg-slate-900 border border-slate-700 rounded-xl px-4 py-2">
    <option value="">— Estado —</option>
    <option value="ok" {% if status=="ok" %}selected{% endif %}>ok</option>
    <option value="error" {% if status=="error" %}selected{% endif %}>error</option>
  </select>

  <button class="md:col-span-3 bg-emerald-500 text-slate-950 rounded-xl px-4 py-2 font-semibold">
    Filtrar
  </button>
</form>

<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
  {% for s in shops %}
    <a href="/shop/{{ s['id'] }}" class="block bg-slate-900 border border-slate-800 rounded-2xl overflow-hidden hover:border-slate-600 transition">
      <div class="h-44 bg-slate-800">
        {% if s['screenshot'] %}
          <img src="/static/{{ s['screenshot'] }}" class="w-full h-44 object-cover" />
        {% else %}
          <div class="w-full h-44 flex items-center justify-center text-slate-400">Sin captura</div>
        {% endif %}
      </div>
      <div class="p-4">
        <div class="text-sm text-slate-400">{{ s['domain'] }}</div>
        <div class="font-semibold truncate">{{ s['title'] or s['url'] }}</div>
        <div class="text-xs text-slate-500 mt-2">
          {{ s['detected_at'] }} •
          <span class="{% if s['status']=='ok' %}text-emerald-400{% else %}text-rose-400{% endif %}">
            {{ s['status'] }}
          </span>
        </div>
      </div>
    </a>
  {% endfor %}
</div>

{% endblock %}